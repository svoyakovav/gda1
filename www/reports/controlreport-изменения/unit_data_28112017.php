<?php	$array = explode("/", $_POST['Data']);	//$ReportType = $_POST['ReportType'];	$UnitType = ($array[1] == "NIL") ? "''" : $array[1];	include($_SERVER['DOCUMENT_ROOT'] . "/libraryes/itl_connect.php");	include("sql_scripts.php");		switch ($array[0]) {		case "1": $sql_current = $sql_script01; break;		case "3": $sql_current = $sql_script03; break;		case "2": $sql_current = $sql_script02; break;		case "4": $sql_current = $sql_script02; break;		/*		case "10": $sql_current = $sql_10; break;		case "11": $sql_current = $sql_11; break;		case "12": $sql_current = $sql_10; break;		case "13": $sql_current = $sql_11; break;		case "14": $sql_current = $sql_12; break;*/	}		$sql_current = str_replace(":pDate",      "'" . $array[10] . "'", $sql_current);	$sql_current = str_replace(":pStartDate", "'" . $array[10] . "'", $sql_current);	$sql_current = str_replace(":pEndDate",   "'" . $array[11] . "'", $sql_current);		switch ($array[12]) {		case "ПС_ВЫГРУЖ":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.ACTION_DATE*Дата выгрузки*width=\"100\"",							"UNIT.COMING_DATE*Дата прибытия*width=\"100\"",							"UNIT.UNIT_OWNER_NAME*Собственник*width=\"160\" align=\"left\"",							"UNIT.SHIPPER_NAME*Грузоотправитель*align=\"left\" width=\"160\"");			break;		case "ПС_СДАНО_ПОРОЖ":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.ACTION_DATE*Дата отправления*width=\"100\"",							"UNIT.UNIT_OWNER_NAME*Собственник*width=\"310\" align=\"left\"",							"UNIT.DESTINATION_STATION_NAME*Станция<br>назначения*align=\"left\" width=\"120\"");			break;		case "ПС_ПРИБ_ПОРОЖ":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.COMING_DATE*Дата прибытия*width=\"100\"",							"UNIT.UNIT_ONE_NOTE*Заметка 1*width=\"140\" align=\"left\"",							"UNIT.UNIT_OWNER_NAME*Собственник*width=\"140\" align=\"left\"",							"UNIT.SHIPPER_NAME*Грузоотправитель*align=\"left\" width=\"150\"");			break;		case "ПС_ПРИБ_ГРУЖ":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.COMING_DATE*Дата прибытия*width=\"100\"",							"UNIT.CARGO_ETSNG_NAME*Номенклатура ЕТСНГ*align=\"left\" width=\"180\"",							"UNIT.CARGO_WEIGHT_NETTO*Вес груза<br>нетто (т)*align=\"right\"",							"UNIT.SHIPPER_NAME*Грузоотправитель*align=\"left\" width=\"180\"");			break;		case "ПС_БРАК":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.COMING_DATE*Дата прибытия*width=\"100\"",							"UNIT.UNIT_ONE_NOTE*Заметка 1*width=\"110\" align=\"left\"",							"UNIT.UNIT_OWNER_NAME*Собственник*width=\"110\" align=\"left\"",							"UNIT.FLAW_NAME*Брак*width=\"80\" align=\"left\"",							"UNIT.FAULT_NAME*Неисправность*width=\"130\" align=\"left\"");			break;		case "ПС_В_ОТСТОЕ":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.COMING_DATE*Дата прибытия*width=\"100\"",							"UNIT.UNIT_ONE_NOTE*Заметка 1*width=\"170\" align=\"left\"",							"UNIT.UNIT_OWNER_NAME*Собственник*width=\"190\" align=\"left\"",							"UNIT.UNIT_VOLUME*Объем<br>кузова*width=\"60\" align=\"right\"");			break;		case "ПС_ГОТ_ПОГР":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.PREPARE_DATE*Дата подготовки*width=\"100\"",							"UNIT.UNIT_ONE_NOTE*Заметка 1*width=\"170\" align=\"left\"",							"UNIT.UNIT_OWNER_NAME*Собственник*width=\"180\" align=\"left\"",							"UNIT.UNIT_VOLUME*Объем<br>кузова*width=\"60\" align=\"right\"");			break;		case "ПС_ПОД_ПОГР":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.ACTION_DATE*Дата подачи<br>под погрузку*width=\"100\"",							"UNIT.UNIT_ONE_NOTE*Заметка 1*width=\"200\" align=\"left\"",							"UNIT.DESTINATION_STATION_NAME*Станция<br>назначения*align=\"left\" width=\"130\"",							"UNIT.DAILY_TASK_ID*Суточное<br>задание*width=\"80\"");			break;		case "ПС_ПОРОЖ_ВСЕГО":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.COMING_DATE*Дата прибытия*width=\"100\"",							"UNIT.UNIT_ONE_NOTE*Заметка 1*width=\"170\" align=\"left\"",							"UNIT.FRONT_NAME*Фронт*width=\"140\" align=\"left\"",							"UNIT.DESTINATION_STATION_NAME*Станция<br>назначения*align=\"left\" width=\"100\"");			break;		case "ПС_СКЛАД":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.LOADING_DATE*Дата погрузки*width=\"100\"",							"UNIT.CARGO_FULL_NAME*Номенклатура предприятия*align=\"left\" width=\"230\"",							"UNIT.CARGO_WEIGHT_NETTO*Вес груза<br>нетто (т)*align=\"right\"",							"UNIT.DAILY_TASK_NOTE*Примечание*align=\"left\" width=\"130\"");			break;		case "ПС_ВСДАЧЕ":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.COMING_DATE*Дата прибытия*width=\"100\"",							"UNIT.CARGO_FULL_NAME*Номенклатура предприятия*align=\"left\" width=\"320\"",							"UNIT.DESTINATION_STATION_NAME*Станция<br>назначения*align=\"left\" width=\"100\"");			break;		case "ПС_СДОК":		case "ПС_ГРУЖ_ВСЕГО":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.LOADING_DATE*Дата погрузки*width=\"100\"",							"UNIT.CARGO_FULL_NAME*Номенклатура предприятия*align=\"left\" width=\"240\"",							"UNIT.CARGO_WEIGHT_NETTO*Вес груза<br>нетто (т)*align=\"right\"",							"UNIT.DESTINATION_STATION_NAME*Станция<br>назначения*align=\"left\" width=\"100\"");			break;		case "ПС_ОФОРМ":		case "ПС_ПОГРУЖ":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.LOADING_DATE*Дата погрузки*width=\"100\"",							"UNIT.CARGO_FULL_NAME*Номенклатура предприятия*align=\"left\" width=\"320\"",							"UNIT.DESTINATION_STATION_NAME*Станция<br>назначения*align=\"left\" width=\"100\"");			break;		case "ПС_ПУСТО":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.CARGO_FULL_NAME*Номенклатура предприятия*align=\"left\" width=\"320\"",							"UNIT.CARGO_WEIGHT_NETTO*Вес груза<br>нетто (т)*align=\"right\"");			break;		// ------- СЫРЬЕ -------- \\		case "С_ПОРОЖ":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.UNLOADING_DATE*Дата выгрузки*width=\"100\"",							"UNIT.UNIT_ONE_NOTE*Заметка 1*width=\"300\" align=\"left\"",							"UNIT.DEPARTURE_STATION_NAME*Станция<br>отправления*align=\"left\" width=\"100\"");			break;		case "С_ПОД_ВЫГР":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.ACTION_DATE*Дата подачи<br>под выгрузку*width=\"100\"",							"UNIT.DEPARTURE_STATION_NAME*Станция<br>отправления*align=\"left\" width=\"100\"",							"UNIT.FCARGO_WEIGHT_NETTO*Вес сырья<br>нетто (т)*align=\"right\"");			break;		case "С_СДАНО":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.ACTION_DATE*Дата отправления*width=\"100\"",							"UNIT.DESTINATION_STATION_NAME*Станция<br>назначения*align=\"left\" width=\"130\"");			break;		case "С_ВЫГРУЖ":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.ACTION_DATE*Дата выгрузки*width=\"100\"",							"UNIT.SHIPPER_NAME*Грузоотправитель*align=\"left\" width=\"230\"",							"UNIT.DEPARTURE_STATION_NAME*Станция<br>отправления*align=\"left\" width=\"100\"",							"UNIT.FCARGO_WEIGHT_NETTO*Вес сырья<br>нетто (т)*align=\"right\"");			break;		case "С_ГРУЖ":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.COMING_DATE*Дата прибытия*width=\"100\"",							"UNIT.SHIPPER_NAME*Грузоотправитель*align=\"left\" width=\"230\"",							"UNIT.DEPARTURE_STATION_NAME*Станция<br>отправления*align=\"left\" width=\"100\"",							"UNIT.FCARGO_WEIGHT_NETTO*Вес сырья<br>нетто (т)*align=\"right\"");			break;		case "С_ПУСТО":			$column = array("UNIT.CAR_NUMBER*Номер<br>единицы*width=\"70\"",							"UNIT.FCARGO_ETSNG_NAME*Сырье*align=\"left\" width=\"310\"");			break;	}		$select = "";	$header = "";	$count = count($column);	for ($i = 0; $i < $count; $i++) {		$arr = explode("*", $column[$i]);		$select = $select . $arr[0] . (($i == $count - 1) ? "" : ", ");		$header = $header . "<th bgcolor=\"#FFDEAD\">" . $arr[1] . "</th>";	}		$sql_current = "		SELECT " . $select . "		FROM (" . $sql_current . ") UNIT		WHERE 1 = 1" .			(($array[2]  == "NIL") ? "" : " AND UNIT.ORGANIZATION_ID "    . (($array[2] == "")  ? "IS NULL" : " = '" . $array[2] . "'")) .			(($array[4]  == "NIL") ? "" : " AND UNIT.CAR_WALKING_ID "     . (($array[4] == "")  ? "IS NULL" : " = "  . $array[4])) .			(($array[3]  == "NIL") ? "" : " AND UNIT.WEIGHT_SIGN "        . (($array[3] == "")  ? "IS NULL" : " = "  . $array[3])) .			(($array[5]  == "NIL") ? "" : " AND UNIT.CAR_OWNER_SIGN "     . (($array[5] == "")  ? "IS NULL" : " = '" . $array[5] . "'")) .			(($array[6]  == "NIL") ? "" : " AND UNIT.UNIT_TYPE_CODE "     . (($array[6] == "")  ? "IS NULL" : " = '" . $array[6] . "'")) .			(($array[8]  == "NIL") ? "" : " AND UNIT.CARGO_CATEGORY_ID "  . (($array[8] == "")  ? "IS NULL" : " = "  . $array[8])) .			(($array[9]  == "NIL") ? "" : " AND UNIT.UNIT_LENGTH "        . (($array[9] == "")  ? "IS NULL" : " = "  . $array[9])) .			(($array[13] == "NIL") ? "" : " AND UNIT.FWEIGHT_SIGN "       . (($array[13] == "") ? "IS NULL" : " = "  . $array[13])) .			(($array[14] == "NIL") ? "" : " AND UNIT.FCARGO_CATEGORY_ID " . (($array[14] == "") ? "IS NULL" : " = "  . $array[14])) .			(($array[7]  == "NIL") ? "" : " AND UNIT.ACTION_TYPE "        . (($array[7] == "")  ? "IS NULL" : " = '" . $array[7] . "'")) . "		ORDER BY UNIT.CAR_NUMBER	";		$select = OCIParse($itl_logon, $sql_current);	OCIExecute($select, OCI_DEFAULT);		$rown = 0;	$result =		"<p>&nbsp;&nbsp;&nbsp;" . (($array[11] == "") ? "Состояние подвижного состава на <b>" . $array[10] . "</b>" : "Анализ и расчет операций между <b>" . $array[10] . " - " . $array[11] . "</b>") . "</p>" .		"<div align=\"left\"><table border=\"0\" cellspacing=\"1\" cellpadding=\"4\" bgcolor=\"#AAAAAA\"><tr><th bgcolor=\"#FFDEAD\">№</th>" . $header . "</tr>";		while (OCIFetch($select)) {        $rown ++;		$result = $result . "<tr><td>" . $rown . "</td>";		for ($i = 0; $i < count($column); $i++) {			$arr = explode("*", $column[$i]);			$result = $result . "<td " . $arr[2] . ">" . OCIResult($select, substr($arr[0], 5)) . "</td>";}		$result = $result . "</tr>";	}	$result = $result . "</table></div>";		echo json_encode(array('data' => $result));	OCIFreeStatement($select);    OCILogOff($itl_logon);?>